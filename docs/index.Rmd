---
title: "Assessment"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```


```{r ggplot_cars, echo=FALSE}
library(ggplot2)

ggplot(cars, aes(x = speed, y = dist)) +
  geom_point(colour = "blue") +
  geom_smooth(method = "lm", se = FALSE, colour = "red") +
  labs(title = "Speed vs Stopping Distance",
       x = "Speed (mph)",
       y = "Stopping Distance (ft)") +
  theme_minimal()
```


#title: "Formative Assessment – Data Science for Health and Biomedical Sciences"


# 1) Topic / Focus

#**Proposed Title:** Monthly Trends in Carbamazepine Prescriptions in Scotland  

#**Focus:**  
#This project explores prescribing patterns of *Carbamazepine*, a medication commonly used for epilepsy and neuropathic pain. Using NHS Scotland’s **Prescriptions in the Community** dataset, the goal is to investigate whether prescribing levels for this drug show any variation across months or regions, and later, to explore whether trends might relate to broader factors such as population size, health board, or prescribing policy changes.


# 2) Initial Data Visualisation

#**Figure 1 – First Exploration of Carbamazepine Prescriptions**

#Below is an initial time-series plot showing total Carbamazepine prescriptions across several months in 2025.



```{r}
# Load libraries

library(tidyverse)
library(lubridate)


# Example URLs for May–July 2025
urls <- c(
  "https://www.opendata.nhs.scot/dataset/84393984-14e9-4b0d-a797-b288db64d088/resource/f02161c1-15f6-4d9f-8be5-01ba613d4303/download/hb_pitc2025_07.csv",
  "https://www.opendata.nhs.scot/dataset/84393984-14e9-4b0d-a797-b288db64d088/resource/9de908b3-9c28-4cc3-aa32-72350a0579d1/download/hb_pitc2025_01_06.csv"
)

# Combine the files
presc <- urls %>% map_dfr(read_csv)

# Convert YYYYMM to date
presc <- presc %>%
  mutate(date = ymd(paste0(PaidDateMonth, "01")))

names(presc)

# Convert YYYYMM to proper date
presc <- presc %>%
  mutate(
    date = ymd(paste0(PaidDateMonth, "01")))

# Filter carbamazepine (using BNF code 030401 or similar)
carbamazepine <- presc %>%
  filter(str_detect(BNFItemDescription, regex("carbamazepine", ignore_case = TRUE))) %>%
  group_by(date) %>%
  summarise(total_items = sum(NumberOfPaidItems, na.rm = TRUE))

# Simple time series plot
ggplot(carbamazepine, aes(x = date, y = total_items)) +
  geom_line(colour = "steelblue") +
  labs(
    title = "Monthly Carbamazepine Prescriptions in Scotland",
    x = "Date",
    y = "Number of Prescription Items"
  ) +
  theme_minimal()
```

The visualisation above shows Carbamazepine prescriptions from January to July 2025. The number of paid prescription items fluctuates slightly between months (around 4,000–4,500), but there is no strong upward or downward trend. These modest changes are likely the result of routine prescribing cycles rather than seasonal effects. Because Carbamazepine is mainly used for long-term conditions such as epilepsy, consistent monthly figures are expected.

Planned next steps:
	•	Combine a full year (or more) of monthly data to reveal longer-term trends and possible seasonal variation.
	•	Add regional grouping (HBT or Health Board) to identify any geographical differences in prescribing.
	•	Normalise the data by local population size (e.g. prescriptions per 1,000 residents) for fair comparisons.
	•	Consider comparing Carbamazepine with other epilepsy drugs to check if similar prescribing patterns occur.
	•	Improve visualisation by adding colour, facets, and context (e.g. lockdown periods, policy changes).
	
	
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
